.names = "{.col}_VAR")) %>%
filter(avg_DEMvote_perc > 0.0001 & avg_REPvote_perc > 0.0001) %>%
mutate(#democrat_county_vote_perc = democrat_county_vote / county_totalvotes,
#republican_county_vote_perc = republican_county_vote / county_totalvotes,
#poll_perc =  polling_station / state_laborForce,
#state_party_control = factor(state_party_control, levels = c("Split", "Democratic", "Republican")), [missing?]
time = case_when(year %in% c("2000", "2004", "2008") ~ 0,
year %in% c("2012", "2016", "2020") ~ 1),
#time = case_when(year %in% c("2016") ~ 0,
#                 year %in% c("2020") ~ 1),
interaction = time * court_return_leg_count_VAR,
) %>%
pdata.frame(index = c("state_abv", "year"))
### WITH polling data results
# dv <- c("log(avg_DEMvote_perc)", "log(avg_REPvote_perc)")
dv <- "log(vep_turnout_rate)"
iv <- "year*redistrict_VAR + log(state_unemploymentRate) + log(statecrime.totals.violent.all)"
dv_label <- c("DEM candidate's % of county votes (log)", "REP candidate's % of county votes (log)")
cov_label <- c("Contested Redistriction",
"Time",
"Interaction (Redistrict x Time)",
#"Polling station per county (log)", [excluded due to singularity issues]
"Voting-Eligible-Population turnout rate (log)",
"Unemployment rate  (log)"
#, "State legislature control - DEM",
#"State legislature control - REP"
)
# Title = Effect of Redistricting on Party Choice in Presidential Elections
f.reg.multi(dv.sav = dv, iv.sav = iv,
dv_label.sav = NULL, cov_label.sav = NULL,
effect.sav = "twoways",
type.sav = "within",
title.sav = "",
# , star.type = "html",
# star.out = paste0("05. Visualizations/", today(), "-regression-tbl-polling-did.html")
)
# Check N & T
summary(plm(as.formula(paste0(dv, "~", iv)),
data = p.df
, effect = "twoways",
model = "within"
))
### Panel Data Frame for DID
p.df <- df %>%
mutate(across(c(court_action_none_count, court_map_drawn_count, court_return_leg_count, court_challenge_rejected_count),
~case_when(. >= 1 ~ 1,
. == 0 ~ 0),
.names = "{.col}_VAR")) %>%
filter(avg_DEMvote_perc > 0.0001 & avg_REPvote_perc > 0.0001) %>%
mutate(#democrat_county_vote_perc = democrat_county_vote / county_totalvotes,
#republican_county_vote_perc = republican_county_vote / county_totalvotes,
#poll_perc =  polling_station / state_laborForce,
#state_party_control = factor(state_party_control, levels = c("Split", "Democratic", "Republican")), [missing?]
time = case_when(year %in% c("2000", "2004", "2008") ~ 0,
year %in% c("2012", "2016", "2020") ~ 1),
#time = case_when(year %in% c("2016") ~ 0,
#                 year %in% c("2020") ~ 1),
interaction = time * court_return_leg_count_VAR,
) %>%
pdata.frame(index = c("state_abv", "year"))
### WITH polling data results
# dv <- c("log(avg_DEMvote_perc)", "log(avg_REPvote_perc)")
dv <- "log(vep_turnout_rate)"
iv <- "time*redistrict_VAR + log(state_unemploymentRate) + log(statecrime.totals.violent.all)"
dv_label <- c("DEM candidate's % of county votes (log)", "REP candidate's % of county votes (log)")
cov_label <- c("Contested Redistriction",
"Time",
"Interaction (Redistrict x Time)",
#"Polling station per county (log)", [excluded due to singularity issues]
"Voting-Eligible-Population turnout rate (log)",
"Unemployment rate  (log)"
#, "State legislature control - DEM",
#"State legislature control - REP"
)
# Title = Effect of Redistricting on Party Choice in Presidential Elections
f.reg.multi(dv.sav = dv, iv.sav = iv,
dv_label.sav = NULL, cov_label.sav = NULL,
effect.sav = "twoways",
type.sav = "within",
title.sav = "",
# , star.type = "html",
# star.out = paste0("05. Visualizations/", today(), "-regression-tbl-polling-did.html")
)
# Check N & T
summary(plm(as.formula(paste0(dv, "~", iv)),
data = p.df
, effect = "twoways",
model = "within"
))
### Panel Data Frame for DID
p.df <- df %>%
mutate(across(c(court_action_none_count, court_map_drawn_count, court_return_leg_count, court_challenge_rejected_count),
~case_when(. >= 1 ~ 1,
. == 0 ~ 0),
.names = "{.col}_VAR")) %>%
filter(avg_DEMvote_perc > 0.0001 & avg_REPvote_perc > 0.0001) %>%
mutate(#democrat_county_vote_perc = democrat_county_vote / county_totalvotes,
#republican_county_vote_perc = republican_county_vote / county_totalvotes,
#poll_perc =  polling_station / state_laborForce,
#state_party_control = factor(state_party_control, levels = c("Split", "Democratic", "Republican")), [missing?]
time = case_when(year %in% c("2000", "2004", "2008") ~ 0,
year %in% c("2012", "2016", "2020") ~ 1),
#time = case_when(year %in% c("2016") ~ 0,
#                 year %in% c("2020") ~ 1),
interaction = time * court_return_leg_count_VAR,
) %>%
pdata.frame(index = c("state_abv", "year"))
### WITH polling data results
# dv <- c("log(avg_DEMvote_perc)", "log(avg_REPvote_perc)")
dv <- "log(vep_turnout_rate)"
iv <- "court_return_leg_count + time + interaction + log(state_unemploymentRate) + log(statecrime.totals.violent.all)"
dv_label <- c("DEM candidate's % of county votes (log)", "REP candidate's % of county votes (log)")
cov_label <- c("Contested Redistriction",
"Time",
"Interaction (Redistrict x Time)",
#"Polling station per county (log)", [excluded due to singularity issues]
"Voting-Eligible-Population turnout rate (log)",
"Unemployment rate  (log)"
#, "State legislature control - DEM",
#"State legislature control - REP"
)
# Title = Effect of Redistricting on Party Choice in Presidential Elections
f.reg.multi(dv.sav = dv, iv.sav = iv,
dv_label.sav = NULL, cov_label.sav = NULL,
effect.sav = "twoways",
type.sav = "within",
title.sav = "",
# , star.type = "html",
# star.out = paste0("05. Visualizations/", today(), "-regression-tbl-polling-did.html")
)
# Check N & T
summary(plm(as.formula(paste0(dv, "~", iv)),
data = p.df
, effect = "twoways",
model = "within"
))
### Panel Data Frame for DID
p.df <- df %>%
mutate(across(c(court_action_none_count, court_map_drawn_count, court_return_leg_count, court_challenge_rejected_count),
~case_when(. >= 1 ~ 1,
. == 0 ~ 0),
.names = "{.col}_VAR")) %>%
filter(avg_DEMvote_perc > 0.0001 & avg_REPvote_perc > 0.0001) %>%
mutate(#democrat_county_vote_perc = democrat_county_vote / county_totalvotes,
#republican_county_vote_perc = republican_county_vote / county_totalvotes,
#poll_perc =  polling_station / state_laborForce,
#state_party_control = factor(state_party_control, levels = c("Split", "Democratic", "Republican")), [missing?]
time = case_when(year %in% c("2000", "2004", "2008") ~ 0,
year %in% c("2012", "2016", "2020") ~ 1),
#time = case_when(year %in% c("2016") ~ 0,
#                 year %in% c("2020") ~ 1),
interaction = time * court_return_leg_count_VAR,
) %>%
pdata.frame(index = c("state_abv", "year"))
### WITH polling data results
# dv <- c("log(avg_DEMvote_perc)", "log(avg_REPvote_perc)")
dv <- "log(vep_turnout_rate)"
iv <- "time*redistrict_VAR + log(state_unemploymentRate) + log(statecrime.totals.violent.all)"
dv_label <- c("DEM candidate's % of county votes (log)", "REP candidate's % of county votes (log)")
cov_label <- c("Contested Redistriction",
"Time",
"Interaction (Redistrict x Time)",
#"Polling station per county (log)", [excluded due to singularity issues]
"Voting-Eligible-Population turnout rate (log)",
"Unemployment rate  (log)"
#, "State legislature control - DEM",
#"State legislature control - REP"
)
# Title = Effect of Redistricting on Party Choice in Presidential Elections
f.reg.multi(dv.sav = dv, iv.sav = iv,
dv_label.sav = NULL, cov_label.sav = NULL,
effect.sav = "twoways",
type.sav = "within",
title.sav = "",
# , star.type = "html",
# star.out = paste0("05. Visualizations/", today(), "-regression-tbl-polling-did.html")
)
# Check N & T
summary(plm(as.formula(paste0(dv, "~", iv)),
data = p.df
, effect = "twoways",
model = "within"
))
### Panel Data Frame for DID
p.df <- df %>%
mutate(across(c(court_action_none_count, court_map_drawn_count, court_return_leg_count, court_challenge_rejected_count),
~case_when(. >= 1 ~ 1,
. == 0 ~ 0),
.names = "{.col}_VAR")) %>%
filter(avg_DEMvote_perc > 0.0001 & avg_REPvote_perc > 0.0001) %>%
mutate(#democrat_county_vote_perc = democrat_county_vote / county_totalvotes,
#republican_county_vote_perc = republican_county_vote / county_totalvotes,
#poll_perc =  polling_station / state_laborForce,
#state_party_control = factor(state_party_control, levels = c("Split", "Democratic", "Republican")), [missing?]
time = case_when(year %in% c("2000", "2004", "2008") ~ 0,
year %in% c("2012", "2016", "2020") ~ 1),
#time = case_when(year %in% c("2016") ~ 0,
#                 year %in% c("2020") ~ 1),
interaction = time * court_return_leg_count_VAR,
) %>%
pdata.frame(index = c("state_abv", "year"))
### WITH polling data results
dv <- c("log(avg_DEMvote_perc)", "log(avg_REPvote_perc)")
# dv <- "log(vep_turnout_rate)"
iv <- "time*redistrict_VAR + log(state_unemploymentRate) + log(statecrime.totals.violent.all)"
dv_label <- c("DEM candidate's % of county votes (log)", "REP candidate's % of county votes (log)")
cov_label <- c("Contested Redistriction",
"Time",
"Interaction (Redistrict x Time)",
#"Polling station per county (log)", [excluded due to singularity issues]
"Voting-Eligible-Population turnout rate (log)",
"Unemployment rate  (log)"
#, "State legislature control - DEM",
#"State legislature control - REP"
)
# Title = Effect of Redistricting on Party Choice in Presidential Elections
f.reg.multi(dv.sav = dv, iv.sav = iv,
dv_label.sav = NULL, cov_label.sav = NULL,
effect.sav = "twoways",
type.sav = "within",
title.sav = "",
# , star.type = "html",
# star.out = paste0("05. Visualizations/", today(), "-regression-tbl-polling-did.html")
)
# Check N & T
summary(plm(as.formula(paste0(dv, "~", iv)),
data = p.df
, effect = "twoways",
model = "within"
))
### Panel Data Frame for DID
p.df <- df %>%
mutate(across(c(court_action_none_count, court_map_drawn_count, court_return_leg_count, court_challenge_rejected_count),
~case_when(. >= 1 ~ 1,
. == 0 ~ 0),
.names = "{.col}_VAR")) %>%
filter(avg_DEMvote_perc > 0.0001 & avg_REPvote_perc > 0.0001) %>%
mutate(#democrat_county_vote_perc = democrat_county_vote / county_totalvotes,
#republican_county_vote_perc = republican_county_vote / county_totalvotes,
#poll_perc =  polling_station / state_laborForce,
#state_party_control = factor(state_party_control, levels = c("Split", "Democratic", "Republican")), [missing?]
time = case_when(year %in% c("2000", "2004", "2008") ~ 0,
year %in% c("2012", "2016", "2020") ~ 1),
#time = case_when(year %in% c("2016") ~ 0,
#                 year %in% c("2020") ~ 1),
interaction = time * court_return_leg_count_VAR,
) %>%
pdata.frame(index = c("state_abv", "year"))
### WITH polling data results
dv <- c("log(avg_DEMvote_perc)", "log(avg_REPvote_perc)")
# dv <- "log(vep_turnout_rate)"
iv <- "time*court_return_leg_count_VAR + log(state_unemploymentRate) + log(statecrime.totals.violent.all)"
dv_label <- c("DEM candidate's % of county votes (log)", "REP candidate's % of county votes (log)")
cov_label <- c("Contested Redistriction",
"Time",
"Interaction (Redistrict x Time)",
#"Polling station per county (log)", [excluded due to singularity issues]
"Voting-Eligible-Population turnout rate (log)",
"Unemployment rate  (log)"
#, "State legislature control - DEM",
#"State legislature control - REP"
)
# Title = Effect of Redistricting on Party Choice in Presidential Elections
f.reg.multi(dv.sav = dv, iv.sav = iv,
dv_label.sav = NULL, cov_label.sav = NULL,
effect.sav = "twoways",
type.sav = "within",
title.sav = "",
# , star.type = "html",
# star.out = paste0("05. Visualizations/", today(), "-regression-tbl-polling-did.html")
)
# Check N & T
summary(plm(as.formula(paste0(dv, "~", iv)),
data = p.df
, effect = "twoways",
model = "within"
))
### Panel Data Frame for DID
p.df <- df %>%
mutate(across(c(court_action_none_count, court_map_drawn_count, court_return_leg_count, court_challenge_rejected_count),
~case_when(. >= 1 ~ 1,
. == 0 ~ 0),
.names = "{.col}_VAR")) %>%
filter(avg_DEMvote_perc > 0.0001 & avg_REPvote_perc > 0.0001) %>%
mutate(#democrat_county_vote_perc = democrat_county_vote / county_totalvotes,
#republican_county_vote_perc = republican_county_vote / county_totalvotes,
#poll_perc =  polling_station / state_laborForce,
#state_party_control = factor(state_party_control, levels = c("Split", "Democratic", "Republican")), [missing?]
time = case_when(year %in% c("2000", "2004", "2008") ~ 0,
year %in% c("2012", "2016", "2020") ~ 1),
#time = case_when(year %in% c("2016") ~ 0,
#                 year %in% c("2020") ~ 1),
interaction = time * court_return_leg_count_VAR,
) %>%
pdata.frame(index = c("state_abv", "year"))
### WITH polling data results
dv <- c("log(avg_DEMvote_perc)", "log(avg_REPvote_perc)")
# dv <- "log(vep_turnout_rate)"
iv <- "time*court_return_leg_count_VAR + log(state_unemploymentRate) + log(statecrime.totals.violent.all)"
dv_label <- c("DEM candidate's % of county votes (log)", "REP candidate's % of county votes (log)")
cov_label <- c("Contested Redistriction",
"Time",
"Interaction (Redistrict x Time)",
#"Polling station per county (log)", [excluded due to singularity issues]
"Voting-Eligible-Population turnout rate (log)",
"Unemployment rate  (log)"
#, "State legislature control - DEM",
#"State legislature control - REP"
)
# Title = Effect of Redistricting on Party Choice in Presidential Elections
f.reg.multi(dv.sav = dv, iv.sav = iv,
dv_label.sav = NULL, cov_label.sav = NULL,
effect.sav = "twoways",
type.sav = "within",
title.sav = "",
# , star.type = "html",
# star.out = paste0("05. Visualizations/", today(), "-regression-tbl-polling-did.html")
)
# Check N & T
# summary(plm(as.formula(paste0(dv, "~", iv)),
#                         data = p.df
#                         , effect = "twoways",
#                         model = "within"
#            ))
### Panel Data Frame for DID
p.df <- df %>%
mutate(across(c(court_action_none_count, court_map_drawn_count, court_return_leg_count, court_challenge_rejected_count),
~case_when(. >= 1 ~ 1,
. == 0 ~ 0),
.names = "{.col}_VAR")) %>%
filter(avg_DEMvote_perc > 0.0001 & avg_REPvote_perc > 0.0001) %>%
mutate(#democrat_county_vote_perc = democrat_county_vote / county_totalvotes,
#republican_county_vote_perc = republican_county_vote / county_totalvotes,
#poll_perc =  polling_station / state_laborForce,
#state_party_control = factor(state_party_control, levels = c("Split", "Democratic", "Republican")), [missing?]
time = case_when(year %in% c("2000", "2004", "2008") ~ 0,
year %in% c("2012", "2016", "2020") ~ 1),
#time = case_when(year %in% c("2016") ~ 0,
#                 year %in% c("2020") ~ 1),
interaction = time * court_return_leg_count_VAR,
) %>%
pdata.frame(index = c("state_abv", "year"))
### WITH polling data results
dv <- c("log(avg_DEMvote_perc)", "log(avg_REPvote_perc)")
# dv <- "log(vep_turnout_rate)"
iv <- "time*court_return_leg_count_VAR + log(state_unemploymentRate) + log(statecrime.totals.violent.all) + plm::lag(log(avg_DEMvote_perc), 4)"
dv_label <- c("DEM candidate's % of county votes (log)", "REP candidate's % of county votes (log)")
cov_label <- c("Contested Redistriction",
"Time",
"Interaction (Redistrict x Time)",
#"Polling station per county (log)", [excluded due to singularity issues]
"Voting-Eligible-Population turnout rate (log)",
"Unemployment rate  (log)"
#, "State legislature control - DEM",
#"State legislature control - REP"
)
# Title = Effect of Redistricting on Party Choice in Presidential Elections
f.reg.multi(dv.sav = dv, iv.sav = iv,
dv_label.sav = NULL, cov_label.sav = NULL,
effect.sav = "twoways",
type.sav = "within",
title.sav = "",
# , star.type = "html",
# star.out = paste0("05. Visualizations/", today(), "-regression-tbl-polling-did.html")
)
# Check N & T
# summary(plm(as.formula(paste0(dv, "~", iv)),
#                         data = p.df
#                         , effect = "twoways",
#                         model = "within"
#            ))
### Panel Data Frame for DID
p.df <- df %>%
mutate(across(c(court_action_none_count, court_map_drawn_count, court_return_leg_count, court_challenge_rejected_count),
~case_when(. >= 1 ~ 1,
. == 0 ~ 0),
.names = "{.col}_VAR")) %>%
filter(avg_DEMvote_perc > 0.0001 & avg_REPvote_perc > 0.0001) %>%
mutate(#democrat_county_vote_perc = democrat_county_vote / county_totalvotes,
#republican_county_vote_perc = republican_county_vote / county_totalvotes,
#poll_perc =  polling_station / state_laborForce,
#state_party_control = factor(state_party_control, levels = c("Split", "Democratic", "Republican")), [missing?]
time = case_when(year %in% c("2000", "2004", "2008") ~ 0,
year %in% c("2012", "2016", "2020") ~ 1),
#time = case_when(year %in% c("2016") ~ 0,
#                 year %in% c("2020") ~ 1),
interaction = time * court_return_leg_count_VAR,
) %>%
pdata.frame(index = c("state_abv", "year"))
### WITH polling data results
dv <- c("log(avg_DEMvote_perc)", "log(avg_REPvote_perc)")
# dv <- "log(vep_turnout_rate)"
iv <- "time*court_return_leg_count_VAR + log(state_unemploymentRate) + log(statecrime.totals.violent.all) + log(vep_turnout_rate) + plm::lag(log(avg_DEMvote_perc), 4)"
dv_label <- c("DEM candidate's % of county votes (log)", "REP candidate's % of county votes (log)")
cov_label <- c("Contested Redistriction",
"Time",
"Interaction (Redistrict x Time)",
#"Polling station per county (log)", [excluded due to singularity issues]
"Voting-Eligible-Population turnout rate (log)",
"Unemployment rate  (log)"
#, "State legislature control - DEM",
#"State legislature control - REP"
)
# Title = Effect of Redistricting on Party Choice in Presidential Elections
f.reg.multi(dv.sav = dv, iv.sav = iv,
dv_label.sav = NULL, cov_label.sav = NULL,
effect.sav = "twoways",
type.sav = "within",
title.sav = "",
# , star.type = "html",
# star.out = paste0("05. Visualizations/", today(), "-regression-tbl-polling-did.html")
)
# Check N & T
# summary(plm(as.formula(paste0(dv, "~", iv)),
#                         data = p.df
#                         , effect = "twoways",
#                         model = "within"
#            ))
### Panel Data Frame for DID
p.df <- df %>%
mutate(across(c(court_action_none_count, court_map_drawn_count, court_return_leg_count, court_challenge_rejected_count),
~case_when(. >= 1 ~ 1,
. == 0 ~ 0),
.names = "{.col}_VAR")) %>%
filter(avg_DEMvote_perc > 0.0001 & avg_REPvote_perc > 0.0001) %>%
mutate(#democrat_county_vote_perc = democrat_county_vote / county_totalvotes,
#republican_county_vote_perc = republican_county_vote / county_totalvotes,
#poll_perc =  polling_station / state_laborForce,
#state_party_control = factor(state_party_control, levels = c("Split", "Democratic", "Republican")), [missing?]
time = case_when(year %in% c("2000", "2004", "2008") ~ 0,
year %in% c("2012", "2016", "2020") ~ 1),
#time = case_when(year %in% c("2016") ~ 0,
#                 year %in% c("2020") ~ 1),
interaction = time * court_return_leg_count_VAR,
) %>%
pdata.frame(index = c("state_abv", "year"))
### WITH polling data results
dv <- c("log(avg_DEMvote_perc)", "log(avg_REPvote_perc)")
# dv <- "log(vep_turnout_rate)"
iv <- "time*court_return_leg_count_VAR + log(state_unemploymentRate) + log(statecrime.totals.violent.all) + log(vep_turnout_rate)"
dv_label <- c("DEM candidate's % of county votes (log)", "REP candidate's % of county votes (log)")
cov_label <- c("Contested Redistriction",
"Time",
"Interaction (Redistrict x Time)",
#"Polling station per county (log)", [excluded due to singularity issues]
"Voting-Eligible-Population turnout rate (log)",
"Unemployment rate  (log)"
#, "State legislature control - DEM",
#"State legislature control - REP"
)
# Title = Effect of Redistricting on Party Choice in Presidential Elections
f.reg.multi(dv.sav = dv, iv.sav = iv,
dv_label.sav = NULL, cov_label.sav = NULL,
effect.sav = "twoways",
type.sav = "within",
title.sav = "",
# , star.type = "html",
# star.out = paste0("05. Visualizations/", today(), "-regression-tbl-polling-did.html")
)
# Check N & T
# summary(plm(as.formula(paste0(dv, "~", iv)),
#                         data = p.df
#                         , effect = "twoways",
#                         model = "within"
#            ))
### Panel Data Frame for DID
p.df <- df %>%
mutate(across(c(court_action_none_count, court_map_drawn_count, court_return_leg_count, court_challenge_rejected_count),
~case_when(. >= 1 ~ 1,
. == 0 ~ 0),
.names = "{.col}_VAR")) %>%
filter(avg_DEMvote_perc > 0.0001 & avg_REPvote_perc > 0.0001) %>%
mutate(#democrat_county_vote_perc = democrat_county_vote / county_totalvotes,
#republican_county_vote_perc = republican_county_vote / county_totalvotes,
#poll_perc =  polling_station / state_laborForce,
#state_party_control = factor(state_party_control, levels = c("Split", "Democratic", "Republican")), [missing?]
time = case_when(year %in% c("2000", "2004", "2008") ~ 0,
year %in% c("2012", "2016", "2020") ~ 1),
#time = case_when(year %in% c("2016") ~ 0,
#                 year %in% c("2020") ~ 1),
interaction = time * court_return_leg_count_VAR,
) %>%
pdata.frame(index = c("state_abv", "year"))
### WITH polling data results
dv <- c("log(avg_DEMvote_perc)", "log(avg_REPvote_perc)")
# dv <- "log(vep_turnout_rate)"
iv <- "time*court_action_none_count_VAR + log(state_unemploymentRate) + log(statecrime.totals.violent.all) + log(vep_turnout_rate)"
dv_label <- c("DEM candidate's % of county votes (log)", "REP candidate's % of county votes (log)")
cov_label <- c("Contested Redistriction",
"Time",
"Interaction (Redistrict x Time)",
#"Polling station per county (log)", [excluded due to singularity issues]
"Voting-Eligible-Population turnout rate (log)",
"Unemployment rate  (log)"
#, "State legislature control - DEM",
#"State legislature control - REP"
)
# Title = Effect of Redistricting on Party Choice in Presidential Elections
f.reg.multi(dv.sav = dv, iv.sav = iv,
dv_label.sav = NULL, cov_label.sav = NULL,
effect.sav = "twoways",
type.sav = "within",
title.sav = "",
# , star.type = "html",
# star.out = paste0("05. Visualizations/", today(), "-regression-tbl-polling-did.html")
)
# Check N & T
# summary(plm(as.formula(paste0(dv, "~", iv)),
#                         data = p.df
#                         , effect = "twoways",
#                         model = "within"
#            ))
