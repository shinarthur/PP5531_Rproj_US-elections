---
title: "U.S. Election Project"
author: "Arthur, Moritz, San Hong"
date: "2024-09-10"
output: html_document
---

# Tasks To-Do

-    Nice graph about voter turn out rate over time (?)

-   

# Setup
```{r setup}

library(here)
library(tidyverse)
library(ggplot2)
library(readr)
library(dplyr)

### Change directory here. 
### As long as file structure is same as github structure, directory does not need to be changed.
knitr::opts_knit$set(root.dir = here::here())

```


```{r import data}
rm(list=ls())

df <- read_rds("04. Outputs/2024-09-24_electiondataset.rds")
### alternative: data <- read_csv("2024-09-24_electiondataset.csv")

legend <- df %>% 
  colnames() %>% 
  as.data.frame()
  
```

# Visualization Section
```{r viz}

```

# Replace NA values in redistrict_count with 0 and clean
X2024_09_24_electiondataset$redistrict_count[is.na(X2024_09_24_electiondataset$redistrict_count)] <- 0
cleaned_data <- X2024_09_24_electiondataset %>%
  filter(!is.na(redistrict_count) & !is.na(vep_turnout_rate))

### Scatter plot of vep_turnout_rate and redistricting counts
ggplot(cleaned_data, aes(x = redistrict_count, y = vep_turnout_rate)) +
  geom_point(alpha = 0.6, color = "blue") +
  labs(title = "VEP Turnout Rate vs. Redistrict Count", 
       x = "Redistrict Count", 
       y = "VEP Turnout Rate") +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  theme_minimal()

### Boxplot visualizing VEP turnout rate grouped by the number of times a county was redistricted
ggplot(cleaned_data, aes(x = as.factor(redistrict_count), y = vep_turnout_rate)) +
  geom_boxplot(fill = "lightgreen") +
  labs(title = "VEP Turnout Rate by Redistrict Count", 
       x = "Redistrict Count", 
       y = "VEP Turnout Rate") +
  theme_minimal()

# Filtering the data for the selected states and removing rows with missing values
cleaned_data_selected_states <- X2024_09_24_electiondataset %>%
  filter(state %in% c("North Carolina", "Wisconsin", "Pennsylvania", "Ohio") & 
           !is.na(redistrict_count) & !is.na(vep_turnout_rate))

### Scatter plot of vep_turnout_rate and redistricting counts
ggplot(cleaned_data_selected_states, aes(x = redistrict_count, y = vep_turnout_rate)) +
  geom_point(alpha = 0.6, color = "blue") +
  labs(title = "VEP Turnout Rate vs. Redistrict Count", 
       x = "Redistrict Count", 
       y = "VEP Turnout Rate") +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  theme_minimal()

### Boxplot visualizing VEP turnout rate grouped by the number of times a county was redistricted
ggplot(cleaned_data_selected_states, aes(x = as.factor(redistrict_count), y = vep_turnout_rate)) +
  geom_boxplot(fill = "lightgreen") +
  labs(title = "VEP Turnout Rate by Redistrict Count", 
       x = "Redistrict Count", 
       y = "VEP Turnout Rate") +
  theme_minimal()
